function ci(t){this.fileNode=this.f(t.file),this.zoom=t.zoom||function(){return 100},this.imageContainer=this.f(t.container),this.limit=t.limit||!0,this.callback=t.callback,this.quality=t.quality||!1,this.className=t.className||"",this.imageWillMount=t.imageWillMount||function(){return!0},this.results=[],this.count=0,this.imageDidMount=t.imageDidMount||function(){return!0},this.zoom=t.zoom||function(t){return t.width?t.width:t.height?t.height:void 0},this.maxFiles=t.maxFiles||!1,this.fileWillStart=t.fileWillStart||!1,this.constructor()}ci.prototype={constructor:function(){var t=this;this.fileNode.setAttribute("multiple","multiple"),this.fileNode.setAttribute("accept","image/*"),this.fileNode.addEventListener("change",function(){var e=this.files;if(t.count=e.length,t.maxFiles&&e.length>t.maxFiles.number)return t.maxFiles.onoverflow(e),!1;for(var i=0;i<this.files.length;i++){if(t.fileWillStart&&!t.fileWillStart(e))return t.count--,!1;t.start(e[i])}})},f:function(t){return"object"==typeof t?t:document.querySelector(t)},writeDOM:function(t){var e=document.createElement("img");e.setAttribute("src",t.base64),e.setAttribute("class",this.className),this.imageContainer.appendChild(e),t.imageNode=e,this.imageDidMount(t)},start:function(t){var e=parseFloat(t.size/1024).toFixed(2),i=new FileReader,s={format:t.type},a=this;i.readAsDataURL(t),i.onload=function(){s.src=this.result,s.filesize=e,s.filename=t.name,s.quality=a.quality?a.quality(e):e/1024>4?20:e>2?40:e>1?60:.2>e?100:85,a.transform(s)}},transform:function(t){var e={},i=this,s=i.createElement("img"),a=new Image;a.src=t.src||"",e.filename=t.filename,s.src=t.src,s.onload=function(){var n=this.width,l=this.height;if(t.width=n,t.height=l,t.limit<0)t.base64=t.src;else if(t.limit===!0||t.filesize>=t.limit){var r=i.createElement("canvas"),o=r.getContext("2d");r.width=i.zoom({width:n}),r.height=i.zoom({height:l}),o.drawImage(a,0,0,r.width,r.height),t.base64=r.toDataURL(t.format,t.quality/100),i.remove(r),i.remove(s)}else t.base64=t.src;e.base64=t.base64,e.filesize=t.filesize,e.source=t.src,i.results.push(e),i.imageWillMount(t)&&i.writeDOM(t),i.results.length==i.count&&(i.callback(i.results),i.results=[])}},remove:function(t){if(!t)return!1;var e=t.parentNode;e&&e.removeChild(t)},createElement:function(t){var e=document.createElement(t);return e.style.display="none",document.body.appendChild(e),e}};