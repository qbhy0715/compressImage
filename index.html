<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>File API Test</title>
    <script src="jquery.min.js"></script>
    <script src="compressImage.js"></script>
</head>

<script>

    $(function (){
        $.fn.compressImg({
            file: '#fileImg',
            img: '#img',
            quality: function (file){
              // 返回数字，0-100.代表图片质量
                return file.size / 1024 /1024 > 4 ? 10 : 50;
            },
            change: function (file){
              var filesize = file.size / 1024 / 1024;

              if(filesize > 4){
                alert('你上传的图片太大啦,请重新选择');
                return false;
              }

                return true;
            },
            callback: function (data){
                $.ajax({
                    url: 'test.php',
                    data: {
                        img: data.base64,
                        filename: data.filename
                    },
                    type: 'post',
                    success: function (data){
                        console.log(data);
                    }
                });
            }
        });
    });


</script>
<body>
    <input accept="image/*" type="file" id="fileImg">
    <img src="" alt="" id="img">
</body>
</html>
